{"version":3,"sources":["learn/lisp.coffee"],"names":[],"mappings":"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","file":"learn/lisp.js","sourceRoot":"/source/","sourcesContent":["tokenize = (input) ->\r\n\tinput.replace(/\\(/g, ' ( ')\r\n\t\t.replace(/\\)/g, ' ) ')\r\n\t\t.split(/ +/)[1...-1]\r\n\r\nt = tokenize(\"\r\n\t(first (t d e))\r\n\t\")\r\nconsole.log t  \r\n\r\nparenthesize = (input, list) ->\r\n\ttoken = input.shift();\r\n\tif token is undefined\r\n\t\treturn list.pop()\r\n\telse if token is '('\r\n\t\tlist.push(parenthesize(input, []))\r\n\t\treturn parenthesize(input, list)\r\n\telse if token is ')'\r\n\t\treturn list\r\n\telse \r\n\t\treturn parenthesize(input,\r\n\t\t\tlist.concat(categrize(token)))\r\n\r\ncategrize = (input) ->\r\n\tif !isNaN(parseFloat(input))\r\n\t\treturn {type: 'lit', val:parseFloat(input)}\r\n\telse\r\n\t\treturn {type: 'id', val: input}\r\n\r\nt = parenthesize(t, [])\r\nconsole.log t\r\n\r\ninterpret = (input, context) ->\r\n\tif context is undefined\r\n\t\treturn interpret(input, new Context(library))\r\n\telse if input instanceof Array\r\n\t\treturn interpretList(input, context)\r\n\telse if input.type is 'id'\r\n\t\treturn interpretId(input, context)\r\n\telse\r\n\t\treturn input.val\r\n\r\ninterpretList = (input, context) ->\r\n\tif special[input[0].val]?\r\n\t\treturn special[input[0].val](input, context)\r\n\telse\r\n\t\tlist = input.map((x) ->\r\n\t\t\treturn interpret(x, context)\r\n\t\t)\r\n\t\tif list[0].type is 'function'\r\n\t\t\treturn list[0].val(list.slice(1))\r\n\t\telse\r\n\t\t\treturn list\r\n\r\nContext = (scope, parent) ->\r\n\t@scope = scope\r\n\t@parent = parent\r\n\t@get = (id) ->\r\n\t\tif @scope[id]?\r\n\t\t\treturn @scope[id]\r\n\t\telse if @parent isnt undefined\r\n\t\t\treturn @parent.get(id)\r\n\r\nlibrary = {\r\n\tfirst: (x) ->\r\n\t\treturn x[0]\r\n}\r\n\r\n"]}